#!/usr/bin/env python
from pwn import *

morseAlphabet ={"A": ".-", "B": "-...", "C": "-.-.", "D": "-..", "E": ".", "F": "..-.",
                "G": "--.", "H": "....", "I": "..", "J": ".---", "K": "-.-", "L": ".-..",
                "M": "--", "N": "-.", "O": "---", "P": ".--.", "Q": "--.-", "R": ".-.",
                "S": "...", "T": "-", "U": "..-", "V": "...-", "W": ".--", "X": "-..-",
                "Y": "-.--", "Z": "--..", " ": "/" }
inverseMorseAlphabet=dict((v,k) for (k,v) in morseAlphabet.items())

p = remote('172.31.2.59', 51966)
p.recvuntil('flag!')
p.recvuntil('\n')
for i in xrange(20):
    # base64
    m = p.recvline().rstrip()
    ret = b64d(m)
    p.sendline(ret)
        print m, ret

    # morse code
    m = p.recvline()
    m = p.recvline()
    m = p.recvline()
    m = m.replace('? ', '')
    m = m.rstrip().split(' ')
    ret = ''
    for i in m:
        ret += inverseMorseAlphabet[i];
    print m,ret
    p.sendline(ret)

    # binary
    m = p.readline()
    m = p.readline().rstrip().replace('? ', '')
    ret = ''
    for i in range(0, len(m), 8):
        ret += chr(int(m[i:i+8], 2))
    print m, ret
    p.sendline(ret)

    # hex
    m = p.readline()
    m = p.readline()
    m = p.readline().rstrip().replace('? ', '')
    ret = ''
    for i in m.split(' '):
        ret += chr(int('0x' + i, 0x10))
    print m, ret
    p.sendline(ret)

    m = p.readline()
    m = p.readline()
print p.recvall()